"use client";

import { AlertCircle, AlertTriangle, Info } from "lucide-react";
import { Badge } from "@/components/ui/badge";
import { cn } from "@/lib/utils";
import {
  SEVERITY_CONFIG,
  type VulnerabilitySeverity,
} from "@/types/vulnerability";

interface VulnerabilitySeverityBadgeProps {
  severity: VulnerabilitySeverity;
  className?: string;
}

export function VulnerabilitySeverityBadge({
  severity,
  className,
}: VulnerabilitySeverityBadgeProps) {
  const config = SEVERITY_CONFIG[severity];

  const getSeverityColor = (severity: VulnerabilitySeverity) => {
    switch (severity) {
      case "CRITICAL":
        return "bg-red-600 hover:bg-red-700 text-white";
      case "HIGH":
        return "bg-orange-500 hover:bg-orange-600 text-white";
      case "MEDIUM":
        return "bg-yellow-500 hover:bg-yellow-600 text-white";
      case "LOW":
        return "bg-blue-500 hover:bg-blue-600 text-white";
      case "NONE":
        return "bg-gray-400 hover:bg-gray-500 text-white";
      default:
        return "bg-gray-400 hover:bg-gray-500 text-white";
    }
  };

  const getSeverityIcon = (severity: VulnerabilitySeverity) => {
    switch (severity) {
      case "CRITICAL":
      case "HIGH":
        return AlertTriangle;
      case "MEDIUM":
        return AlertCircle;
      case "LOW":
      case "NONE":
        return Info;
      default:
        return Info;
    }
  };

  const Icon = getSeverityIcon(severity);

  return (
    <Badge className={cn(getSeverityColor(severity), "gap-1", className)}>
      <Icon className="h-3 w-3" />
      {config.label}
    </Badge>
  );
}
